{"ast":null,"code":"import _slicedToArray from\"/home/asus/React_Shop_App/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from\"react\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faSearch}from\"@fortawesome/free-solid-svg-icons\";import{useDebounce}from\"../../hooks/debounce\";import{useGetProductByIdQuery,useGetProductsAllQuery}from\"../../redux/products/products.api\";import{Link}from\"react-router-dom\";import{Context}from\"../../context/context\";import{useDispatch,useSelector}from\"react-redux\";import{setSearchFilterProducts,toggleSearchForm}from\"../../redux/products/products.slice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export function Search(){var filtersProducts=[];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),dropdown=_useState4[0],setDropdown=_useState4[1];var contextId=useContext(Context);var debounced=useDebounce(search);var dispatch=useDispatch();var searchField=useSelector(function(state){return state.product.search;});var _useGetProductByIdQue=useGetProductByIdQuery(contextId.id),refetch=_useGetProductByIdQue.refetch;var _useGetProductsAllQue=useGetProductsAllQuery(debounced,{skip:debounced.length<2// refetchOnFocus: true\n}),data=_useGetProductsAllQue.data;var clickHandler=function clickHandler(productId){setDropdown(false);dispatch(toggleSearchForm(false));contextId.id=productId;refetch();};var toggleForm=function toggleForm(){return dispatch(toggleSearchForm(false));};useEffect(function(){setDropdown(debounced.length>=3&&(data===null||data===void 0?void 0:data.length)>0);},[debounced,data]);var products=function products(){if(debounced.length>=2&&(data===null||data===void 0?void 0:data.length)>0){return data===null||data===void 0?void 0:data.filter(function(product){if(product.title.toLowerCase().includes(search.toLowerCase())){filtersProducts.push(product);return product;}}).map(function(product,index){return/*#__PURE__*/_jsxs(Link,{to:\"/products/\".concat(product.id),onClick:function onClick(){return clickHandler(product.id);},className:\"text-black flex items-center max-h-[80px] mb-4 border-b pb-2 last:border-0 last:mb-0 hover:opacity-50 transition\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-[50px] mr-4 max-h-[75px]\",src:product.image,alt:product.title}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-base\",children:product.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-md font-medium\",children:[\"$ \",product.price]})]})]},index);});}};var submitSearchForm=function submitSearchForm(event){event.preventDefault();if(search!==''){dispatch(setSearchFilterProducts(filtersProducts));dispatch(toggleSearchForm(false));}setDropdown(false);};return/*#__PURE__*/_jsxs(_Fragment,{children:[searchField&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 right-0 top-0 bottom-0 w-full h-[100vh] z-10 bg-gray-300/50\",onClick:toggleForm}),/*#__PURE__*/_jsxs(\"form\",{className:\"\".concat(searchField?'absolute top-3 left-0 mx-auto right-0 w-[90%] bg-white z-20 rounded shadow-md flex items-center justify-between':'bg-white rounded rounded-r-md hidden items-center relative w-[390px] md:flex md:justify-between'),onSubmit:submitSearchForm,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch,className:\"text-black pr-1 pl-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search products...\",className:\"px-1 text-lg text-black outline-0 h-[35px] w-full focus:outline-none\",value:search,onChange:function onChange(e){return setSearch(e.target.value);}}),/*#__PURE__*/_jsx(\"input\",{className:\"bg-black h-[35px] px-3 rounded-r hover:bg-gray-700 transition cursor-pointer\",type:\"submit\",value:\"Find\"}),dropdown&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 top-[36px] right-0 bg-white p-2 border border-black rounded max-h-[500px] overflow-y-auto search-box\",children:products()})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useState","FontAwesomeIcon","faSearch","useDebounce","useGetProductByIdQuery","useGetProductsAllQuery","Link","Context","useDispatch","useSelector","setSearchFilterProducts","toggleSearchForm","Search","filtersProducts","search","setSearch","dropdown","setDropdown","contextId","debounced","dispatch","searchField","state","product","id","refetch","skip","length","data","clickHandler","productId","toggleForm","products","filter","title","toLowerCase","includes","push","map","index","image","price","submitSearchForm","event","preventDefault","e","target","value"],"sources":["/home/asus/React_Shop_App/src/components/search/Search.js"],"sourcesContent":["import React, {useContext, useEffect, useState} from \"react\"\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\"\nimport {faSearch} from \"@fortawesome/free-solid-svg-icons\"\nimport {useDebounce} from \"../../hooks/debounce\"\nimport {useGetProductByIdQuery, useGetProductsAllQuery} from \"../../redux/products/products.api\"\nimport {Link} from \"react-router-dom\"\nimport {Context} from \"../../context/context\"\nimport {useDispatch, useSelector} from \"react-redux\"\nimport {setSearchFilterProducts, toggleSearchForm} from \"../../redux/products/products.slice\"\n\nexport function Search() {\n    const filtersProducts = []\n    const [search, setSearch] = useState('')\n    const [dropdown, setDropdown] = useState(false)\n\n    const contextId = useContext(Context)\n    const debounced = useDebounce(search)\n    const dispatch = useDispatch()\n\n    const searchField = useSelector(state => state.product.search)\n\n    const {refetch} = useGetProductByIdQuery(contextId.id)\n\n    const {data} = useGetProductsAllQuery(debounced, {\n        skip: debounced.length < 2,\n        // refetchOnFocus: true\n    })\n\n    const clickHandler = (productId) => {\n        setDropdown(false)\n        dispatch(toggleSearchForm(false))\n        contextId.id = productId\n        refetch()\n    }\n\n    const toggleForm = () => dispatch(toggleSearchForm(false))\n\n    useEffect(() => {\n        setDropdown(debounced.length >= 3 && data?.length > 0)\n    }, [debounced, data])\n\n    const products = () => {\n        if (debounced.length >= 2 && data?.length > 0) {\n            return data?.filter(product => {\n                if (product.title.toLowerCase().includes(search.toLowerCase())) {\n                    filtersProducts.push(product)\n                    return product\n                }\n            }).map((product,index) => {\n                return <Link to={`/products/${product.id}`} onClick={() => clickHandler(product.id)}\n                             className='text-black flex items-center max-h-[80px] mb-4 border-b pb-2 last:border-0 last:mb-0 hover:opacity-50 transition'\n                             key={index}>\n                    <img className='w-[50px] mr-4 max-h-[75px]' src={product.image} alt={product.title}/>\n                    <div>\n                        <p className='text-base'>{product.title}</p>\n                        <p className='text-md font-medium'>$ {product.price}</p>\n                    </div>\n                </Link>\n            })\n        }\n    }\n\n    const submitSearchForm = event => {\n        event.preventDefault()\n        if (search !== '') {\n            dispatch(setSearchFilterProducts(filtersProducts))\n            dispatch(toggleSearchForm(false))\n        }\n        setDropdown(false)\n    }\n\n    return (\n        <>\n            { searchField && <div className='absolute left-0 right-0 top-0 bottom-0 w-full h-[100vh] z-10 bg-gray-300/50' onClick={toggleForm}/> }\n\n            <form\n                className={`${searchField ? 'absolute top-3 left-0 mx-auto right-0 w-[90%] bg-white z-20 rounded shadow-md flex items-center justify-between' : 'bg-white rounded rounded-r-md hidden items-center relative w-[390px] md:flex md:justify-between'}`}\n                onSubmit={submitSearchForm}\n            >\n                <FontAwesomeIcon icon={faSearch} className='text-black pr-1 pl-2'/>\n                <input\n                    type=\"text\"\n                    placeholder='Search products...'\n                    className='px-1 text-lg text-black outline-0 h-[35px] w-full focus:outline-none'\n                    value={search}\n                    onChange={e => setSearch(e.target.value)}\n                />\n                <input\n                    className='bg-black h-[35px] px-3 rounded-r hover:bg-gray-700 transition cursor-pointer'\n                    type='submit'\n                    value='Find'\n                />\n\n                {dropdown &&\n                    <div className='absolute left-0 top-[36px] right-0 bg-white p-2 border border-black rounded max-h-[500px] overflow-y-auto search-box'>\n                        { products() }\n                    </div>\n                }\n\n            </form>\n        </>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}